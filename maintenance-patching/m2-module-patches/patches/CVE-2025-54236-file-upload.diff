# Patch to resolve file upload vulnerability being exploited as part of Session Reaper (CVE-2025-54236)
# Credit to @hostep for the Magento implementation (rather than native PHP)
--- a/vendor/magento/module-customer/Controller/Address/File/Upload.php
+++ b/vendor/magento/module-customer/Controller/Address/File/Upload.php
@@ -70,6 +70,11 @@ class Upload extends Action implements HttpPostActionInterface
      */
     public function execute()
     {
+        // Prevent upload part of CVE-2025-54236
+        $resultJson = $this->resultFactory->create(ResultFactory::TYPE_JSON);
+        $resultJson->setData($this->processError('Forbidden'));
+        return $resultJson;
+
         try {
             $requestedFiles = $this->getRequest()->getFiles('custom_attributes');
             if (empty($requestedFiles)) {
